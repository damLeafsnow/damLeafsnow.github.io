### 流水线技术

1. 概念

   - 相关参数计算:**流水线执行时间计算**、**流水线吞吐率**、流水线加速比、流水线效率

   - 流水线是指在程序执行时**多条指令重叠进行操作**的一种准并行处理实现技术。针对不同指令各种部件同时处理，提高部件利用率和指令的平均执行速度。

     - 取指->分析->执行 

       不使用流水线

       | 取指 | 1    |      |      | 2    |      |      | 3    |      |      |
       | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
       | 分析 |      | 1    |      |      | 2    |      |      | 3    |      |
       | 执行 |      |      | 1    |      |      | 2    |      |      | 3    |

       流水线处理

       | 取指 |  1   |  2   |  3   |      |      |
       | :--: | :--: | :--: | :--: | :--: | :--: |
       | 分析 |      |  1   |  2   |  3   |      |
       | 执行 |      |      |  1   |  2   |  3   |

       利用空余时间片



### 流水线计算

- 流水线周期为执行时间最长的一段
- 流水线计算公式:
  - 1条指令执行时间+(指令条数-1)*流水线周期
  - **理论公式：(t1+t2+..+tk)+(n-1)*Δt**（无答案时用实践公式）
  - 实践公式：k\*Δt+(n-1)\*Δt



### 超标量流水线

度:同时操作的流水线数量

​	度为2,只需要1/2条指令的执行时间

| 取指 | 1    | 3    | 5    | .    | .    | .    | n-1  |      |      |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 取指 | 2    | 4    | 6    | .    | .    | .    | n    |      |      |
| 分析 |      | 1    | 3    | 5    | .    | .    | .    | n-1  |      |
| 分析 |      | 2    | 4    | 6    | .    | .    | .    | n    |      |
| 执行 |      |      | 1    | 3    | 5    | .    | .    | .    | n-1  |
| 执行 |      |      | 2    | 4    | 6    | .    | .    | .    | n    |



### 流水线吞吐率计算

- 流水线的吞吐率**TP**(Though Put rate):在**单位时间内流水线所完成的任务数量或输出的结果数量**。

- 计算公式:

  $$TP={指令条数\over流水线执行时间}$$

- 流水线最大吞吐率:

  $${TP_{max}=\frac1{Δt}}$$

